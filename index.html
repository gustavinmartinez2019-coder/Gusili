<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Para mi ni√±a ‚ù§Ô∏è</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== RESET ===== */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}

/* ===== FONDO ===== */
body{
    background: linear-gradient(120deg, #ff758c, #ff7eb3);
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
}

/* ===== SOBRE ===== */
.envelope-container{
    position:relative;
    width:620px;
    height:320px;
    cursor:pointer;
}

.envelope{
    position:relative;
    width:100%;
    height:100%;
    background:#fff;
    border-radius:10px;
    box-shadow:0 20px 40px rgba(0,0,0,.25);
    overflow:hidden;
}

/* TAPA */
.envelope::before{
    content:'';
    position:absolute;
    inset:0;
    background:#f7d6e0;
    clip-path: polygon(0 0, 50% 55%, 100% 0);
    transform-origin:top;
    transition:transform 1s ease;
    z-index:4;
}

/* ===== CARTA ===== */
.letter{
    position:absolute;
    bottom:-150%;
    left:50%;
    transform:translateX(-50%);
    width:95%;
    max-width:560px;
    max-height:75vh;
    background:#fff;
    border-radius:12px;
    padding:24px;
    text-align:center;
    box-shadow:0 15px 35px rgba(0,0,0,.25);
    transition:bottom 1.2s ease;
    z-index:6;
    overflow-y:auto;
    -webkit-overflow-scrolling: touch;
    touch-action: pan-y;
}

.letter h2{
    color:#ff4f81;
    margin-bottom:12px;
}

.letter p{
    font-size:16px;
    color:#444;
    line-height:1.6;
}

/* ===== FIRMA ===== */
.signature{
    margin-top:20px;
    font-size:22px;
    color:#ff4f81;
    font-family:'Brush Script MT','Segoe Script',cursive;
    opacity:0;
    white-space:nowrap;
    border-right:2px solid #ff4f81;
    width:0;
}

/* ===== ESTADO ABIERTO ===== */
.open .letter{
    bottom:20px;
}

.open .envelope::before{
    transform:rotateX(180deg);
}

/* ===== TEXTO ===== */
.tap-text{
    position:absolute;
    bottom:-38px;
    width:100%;
    text-align:center;
    color:#fff;
    font-size:14px;
}

/* ===== BOT√ìN M√öSICA ===== */
#musicBtn{
    position:fixed;
    bottom:20px;
    right:20px;
    background:rgba(255,255,255,.9);
    border:none;
    padding:10px 16px;
    border-radius:30px;
    cursor:pointer;
    font-size:14px;
    box-shadow:0 8px 20px rgba(0,0,0,.25);
}

/* ===== RESPONSIVE ===== */
@media (max-width:600px){
    .envelope-container{
        width:90%;
        height:260px;
    }
    .letter{
        padding:18px;
        font-size:15px;
        max-height:70vh;
    }
}
</style>
</head>

<body>

<audio id="music" loop>
    <source src="musica.mp3" type="audio/mpeg">
</audio>

<div class="envelope-container" id="envelope">
    <div class="envelope">
        <div class="letter">
            <h2>Para Ti ‚ù§Ô∏è</h2>
            <p>
                Desde que llegaste a mi vida, todo tiene m√°s color,
                m√°s sentido y m√°s amor.
                <br><br>
                Eres tan especial y tan importante para m√≠;
                tan hermosa, tan simp√°tica, tan bella y carism√°tica.
                Quiero que seas t√∫.
                <br><br>
                No es solo el 14 de febrero,
                es cada d√≠a que sonr√≠o al pensarte.
                <br><br>
                Gracias por existir y por elegirme.
                Te amo.
            </p>

            <div class="signature" id="firma">‚Äî Con amor, Güíï</div>
        </div>
    </div>
    <div class="tap-text">Toca o desliza üíå</div>
</div>

<button id="musicBtn">üîä M√∫sica</button>

<script>
const envelope = document.getElementById("envelope");
const music = document.getElementById("music");
const musicBtn = document.getElementById("musicBtn");
const firma = document.getElementById("firma");

let abierto = false;
let musicaActiva = true;

/* ===== CLICK ===== */
envelope.addEventListener("click", () => toggleEnvelope());

function toggleEnvelope(){
    abierto = !abierto;
    envelope.classList.toggle("open");

    if (abierto && musicaActiva){
        music.volume = 0;
        music.play();
        fadeIn();
        escribirFirma();
    } else {
        fadeOut();
        resetFirma();
    }
}

/* ===== M√öSICA ===== */
musicBtn.addEventListener("click", () => {
    musicaActiva = !musicaActiva;
    musicBtn.textContent = musicaActiva ? "üîä M√∫sica" : "üîá M√∫sica";
    if (!musicaActiva) fadeOut();
});

/* ===== FADE ===== */
function fadeIn(){
    let v = 0;
    const i = setInterval(()=>{
        if(v < .4){
            v += .02;
            music.volume = v;
        } else clearInterval(i);
    },200);
}

function fadeOut(){
    let v = music.volume;
    const i = setInterval(()=>{
        if(v > 0){
            v -= .02;
            music.volume = v;
        } else{
            clearInterval(i);
            music.pause();
        }
    },200);
}

/* ===== FIRMA ===== */
function escribirFirma(){
    const texto = "‚Äî Con amor, Güíï";
    firma.textContent = "";
    firma.style.opacity = 1;
    firma.style.width = "0";
    let i = 0;

    const escribir = setInterval(()=>{
        if(i < texto.length){
            firma.textContent += texto.charAt(i);
            firma.style.width = (i+1)+"ch";
            i++;
        } else{
            clearInterval(escribir);
            firma.style.borderRight = "none";
        }
    },120);
}

function resetFirma(){
    firma.textContent = "";
    firma.style.opacity = 0;
    firma.style.width = "0";
    firma.style.borderRight = "2px solid #ff4f81";
}

/* ===== SWIPE M√ìVIL ===== */
let startY = 0;

envelope.addEventListener("touchstart", e=>{
    startY = e.touches[0].clientY;
},{passive:true});

envelope.addEventListener("touchend", e=>{
    const endY = e.changedTouches[0].clientY;
    const delta = startY - endY;

    if(delta > 60 && !abierto) toggleEnvelope();
    if(delta < -60 && abierto) toggleEnvelope();
},{passive:true});
</script>

</body>
</html>
